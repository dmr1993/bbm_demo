#include "AES.h"
#include <string.h>
int main()
{
	// 测试AES算法
	unsigned char key_enc[16] = {0x9b,0xab,0x5e,0x76,0xa4,0xd6,0x73,0xb9,0xa8,0xef,0x7a,0xba,0xdf,0xd3,0x15,0xc7}; 
	unsigned char key_mac[16] =	{0x6b,0x0b,0x9b,0xfb,0x6b,0x76,0xfe,0x94,0x07,0x04,0x7f,0xf7,0xd3,0x0b,0xda,0x0d};	// 密钥
	unsigned char IV[32]		 = {0x00};	// 初始化向量
	unsigned char PlainText[32]  = {0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x74,0x57,0x5F,0x6D,0xB2,0xC3,0x57,0xA5,
									0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F};	// 明文
	unsigned char CipherText_1[48] ={0x00};// {0x69, 0xc4, 0xe0, 0xd8, 0x6a, 0x7b, 0x04, 0x30, 0xd8, 0xcd, 0xb7, 0x80, 0x70, 0xb4, 0xc5, 0x5a};	// 密文
	unsigned char CipherText_2[48] ={0x00};

	AES_Init(key_enc);												//  8ms @7.3728MHz
	AES_Encrypt(PlainText, CipherText_1, sizeof(PlainText), IV);	// 13ms @7.3728MHz
	
	memcpy(CipherText_1+32,"\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00",0x10);

    AES_Init(key_mac);	

	AES_Encrypt(CipherText_1, CipherText_2, sizeof(CipherText_1), IV);	// 13ms @7.3728MHz

	memcpy(CipherText_1+32,CipherText_2+32,0x10);

//	AES_Decrypt(PlainText, CipherText, sizeof(PlainText), IV);	// 15ms @7.3728MHz


	return 0;
}
